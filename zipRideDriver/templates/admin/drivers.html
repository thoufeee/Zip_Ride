{{ define "admin/drivers.html" }}
    {{ template "base" . }}
{{ end }}

{{ define "page-title" }}Driver Management{{ end }}

{{ define "content" }}
<style>
    .drivers-page {
        display: flex;
        flex-direction: column;
        gap: 24px;
    }

    .drivers-header {
        background: white;
        border-radius: 16px;
        padding: 28px;
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
        border: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 16px;
    }

    .drivers-header h2 {
        margin: 0;
        font-size: 26px;
        font-weight: 700;
        color: #1f2937;
    }

    .drivers-header p {
        margin: 6px 0 0;
        color: #6b7280;
        font-size: 14px;
    }

    .drivers-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        background: white;
        border-radius: 14px;
        padding: 16px 20px;
        box-shadow: 0 6px 20px rgba(15, 23, 42, 0.06);
        border: 1px solid #e2e8f0;
    }

    .drivers-filters select,
    .drivers-filters button {
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid #d1d5db;
        background: white;
        font-size: 14px;
        color: #1f2937;
    }

    .drivers-filters button {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: white;
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .drivers-filters button:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 20px rgba(99, 102, 241, 0.25);
    }

    .drivers-table-wrapper {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid #e2e8f0;
        box-shadow: 0 12px 32px rgba(15, 23, 42, 0.08);
    }

    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
    }

    thead {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(129, 140, 248, 0.08) 100%);
    }

    th {
        text-align: left;
        padding: 16px 18px;
        font-weight: 600;
        color: #374151;
        text-transform: uppercase;
        font-size: 12px;
        letter-spacing: 0.5px;
    }

    td {
        padding: 18px;
        border-top: 1px solid #edf2f7;
        color: #1f2937;
        vertical-align: middle;
    }

    tbody tr:hover {
        background: #f8fafc;
    }

    .driver-vehicle {
        color: #64748b;
        font-size: 13px;
    }

    .status-pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        border-radius: 999px;
        font-weight: 600;
        text-transform: capitalize;
        font-size: 12px;
    }

    .status-pill.Pending { background: rgba(251, 191, 36, 0.15); color: #b45309; }
    .status-pill.Approved { background: rgba(34, 197, 94, 0.15); color: #047857; }
    .status-pill.Rejected { background: rgba(248, 113, 113, 0.15); color: #b91c1c; }
    .status-pill.Suspended { background: rgba(248, 113, 113, 0.15); color: #b91c1c; }
    .status-pill.Banned { background: rgba(107, 114, 128, 0.2); color: #111827; }

    .drivers-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .drivers-actions a,
    .drivers-actions button {
        padding: 8px 14px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .action-view { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; text-decoration: none; display: inline-flex; align-items: center; }
    .action-suspend { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); color: white; }
    .action-approve { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white; }

    .drivers-actions a:hover,
    .drivers-actions button:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 16px rgba(15, 23, 42, 0.15);
    }

    .empty-state {
        text-align: center;
        padding: 48px 24px;
        color: #6b7280;
        font-size: 15px;
    }

    .drivers-count {
        text-align: center;
        color: #6b7280;
        font-size: 14px;
    }

    .drivers-count span { font-weight: 600; color: #4f46e5; }

    .form-inline { display: inline; }

    @media (max-width: 1024px) {
        .drivers-actions { flex-direction: column; align-items: flex-start; }
    }

    @media (max-width: 640px) {
        th, td { padding: 12px; font-size: 13px; }
        .drivers-header { flex-direction: column; }
    }
</style>

<div class="drivers-page">
    <div class="drivers-header">
        <div>
            <h2>Driver Management</h2>
            <p>Monitor onboarding progress, verification status, and take actions on driver accounts.</p>
        </div>
    </div>

    {{ if .Error }}
    <div class="alert alert-error">{{ .Error }}</div>
    {{ end }}

    <form class="drivers-filters" method="GET" action="/admin/panel/drivers">
        <select name="status">
            <option value="" {{if eq .FilterStatus ""}}selected{{end}}>All statuses</option>
            <option value="Pending" {{if eq .FilterStatus "Pending"}}selected{{end}}>Pending</option>
            <option value="Approved" {{if eq .FilterStatus "Approved"}}selected{{end}}>Approved</option>
            <option value="Rejected" {{if eq .FilterStatus "Rejected"}}selected{{end}}>Rejected</option>
            <option value="Suspended" {{if eq .FilterStatus "Suspended"}}selected{{end}}>Suspended</option>
            <option value="Banned" {{if eq .FilterStatus "Banned"}}selected{{end}}>Banned</option>
        </select>
        <button type="submit">Apply filter</button>
        {{ if .FilterStatus }}
        <a href="/admin/panel/drivers" class="reset-link">Reset</a>
        {{ end }}
    </form>

    <div class="drivers-table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Phone</th>
                    <th>Vehicle</th>
                    <th>Status</th>
                    <th>Rating</th>
                    <th>Verified</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{ range .Drivers }}
                <tr>
                    <td>#{{ .ID }}</td>
                    <td>{{ .Name }}</td>
                    <td>{{ .Phone }}</td>
                    <td>
                        {{ if .VehicleModel }}{{ .VehicleModel }}{{ else }}—{{ end }}
                        {{ if .VehicleNumber }}<div class="driver-vehicle">{{ .VehicleNumber }}</div>{{ end }}
                    </td>
                    <td><span class="status-pill {{ .Status }}">{{ .Status }}</span></td>
                    <td>★ {{ printf "%.1f" .Rating }}</td>
                    <td>{{ if .IsVerified }}Yes{{ else }}No{{ end }}</td>
                    <td>{{ .CreatedAt.Format "2006-01-02" }}</td>
                    <td>
                        <div class="drivers-actions">
                            <a href="/admin/panel/driver/{{ .ID }}" class="action-view">View</a>
                            {{ if eq .Status "Approved" }}
                                <form class="form-inline" method="POST" action="/admin/panel/driver/{{ .ID }}/suspend">
                                    <button type="submit" class="action-suspend">Suspend</button>
                                </form>
                            {{ else if eq .Status "Pending" }}
                                <form class="form-inline" method="POST" action="/admin/panel/driver/{{ .ID }}/approve">
                                    <button type="submit" class="action-approve">Approve</button>
                                </form>
                            {{ end }}
                        </div>
                    </td>
                </tr>
                {{ else }}
                <tr>
                    <td colspan="9" class="empty-state">
                        No drivers found. {{ if .FilterStatus }}Try changing the status filter.{{ end }}
                    </td>
                </tr>
                {{ end }}
            </tbody>
        </table>
    </div>

    {{ if .Drivers }}
    <div class="drivers-count">
        Showing <span>{{ len .Drivers }}</span> driver records
    </div>
    {{ end }}
</div>
{{ end }}
